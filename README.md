# Трехосное нагружение цилиндра
## Решение задачи линейной упругости
Рассматриваем цисленное решение задачи о трехосном нагружении цилиндра (трехосный тест) для определния критерия разршения Кулона и состояния напряжений по Андерсону.

Изначально цилиндр находится в недеформированном состоянии. К нему прикладывается сила $\vec{F}$ по напряжению $\sigma$ ($\vec{F} = \sigma _{0} \vec{n}$) в результате чего 
цилиндр деформируется. $\sigma _{0} = [1, 1, 10, 0, 0, 0]$ - тензор напряжений в терминах Войта, $\vec{n} = [n _{x}, n _{y},  n _{z}]$ - нормаль к поверхности цилиндра в точке.
На нижней грани цилиндра смещения $\vec{u}$ зафиксированы

Численное решение данной задачи производим с помощью модели линейной упругости:

<h3 align="center">$div \sigma = -\vec{b},$ $\sigma = C:\epsilon,$ $\epsilon = \frac{ \nabla \vec{u} + \nabla {\vec{u}}^{T}}{2}$

где $\vec{u} = (u, v, w)$ - смещение точки, $\vec{b}$ - вектор результирующих приложенных к телу внешних сил,
$\epsilon$ - тензор малых деформаций, $С$ - тензор жесткости

с граничными условиями:

<h3 align="center">$\alpha \vec{u} - \beta \sigma \vec{n} = \vec{\gamma}$

где $\alpha -$ тензор 3-го порядка, условия типа Дирихле, $\alpha$ = ${\alpha}_{\bot} n n^{T}$ - ${\alpha} _{||}$ $(n n^{T} - \mathbb{I})$

$\beta -$ тензор 3-го порядка, условия типа Неймана, $\beta$ = ${\beta}_{\bot} n n^{T}$ - $\beta _{||} (n n^{T} - \mathbb{I})$

Численное решение данной задачи линейной упругости осуществляется путем дискретизации уравнений методом конечных объемов (МКО) на дуальной сетке (смещения $\vec{u}$ расположены в узлах исходной сетки и в центрах дуальных ячеек) с использованием 
<a href="https://github.com/INMOST-DEV/INMOST ">INMOST</a>

В численном решении задаются граничные условия следующим образом:

На всех гранях цилиндра, кроме нижней задается сила по тензору напряжений $\sigma _{0}$: $\vec{\gamma} = ( \sigma _{0} \vec{n} , 0, 0)$, $\alpha _{||} = \alpha _{\bot} = 0$,  $\beta _{||} = \beta _{\bot} = 1$

Условие на отсутсвие смещений на нижней грани ($\vec{n} = (0, 0, -1)$ цилиндра: $\vec{\gamma} = ( 0, 0, 0)$, $\alpha _{||} = \alpha _{\bot} = 1$,  $\beta _{||} = \beta _{\bot} = 0$

Ниже представлено полученное в результате решения вышепоставленной задачи линейной упругости для трехосного сжатия цилиндра:

<h1 align="center"> Поле напряжений $\sigma$ в цилиндре
  
Начальное состояние цилиндра$ |  Рассчитанное деформированное состояние цилиндра
:-------------------------:|:-------------------------:
![My Image](pics/uvw.png)  |  ![My Image](pics/uvw_an.png)

Из графика также видно, что в результате цилиндр сжался в вертикальном направлении и растянулся в горизонтальных направлениях

## критерия разршения Кулона и состояние напряжений по Андерсону.

Для определения критерия разрушения Кулона и состояния напряжений по Андерсону:

В каждой ячейке:

• Найдем главные напряжения $[S1, S2, S3]$ и оси для тензора напряжений $\sigma$(через SVD) (P.S: могут быть также рассчитаны аналитически через 
основные инварианты)

• Определим $Sv, Shmin, SHmax$: найдем собственный вектор с максимальной по модулю проекцией на ось $z$. Ему будет соответсвовать
собственное число $Si = Sv$. Оставшиеся две компоненты $Si$ - это $Shmin$ и $SHmax$.

• Посчитаем состояние напряжения $A _{phi} (по т. Андерсона)$:

  $A _{phi} = (n + 0.5) + (-1)^{n} (\phi - 0.5),$ где $\phi = \frac{S2 - S3}{S1 - S3}$, $n$ - определяем в зависимости от порядка $Sv, Shmin$ и $SHmax$
  
• Посчитаем критерий разрушения Кулона $CFF$:

  $CFF = \tau - \mu \sigma _{n} - S _{0}$, где $\sigma _{n} = (S _{1} + S _{3})/2$, $\tau = (S _{1} - S _{3})/2$
  
  Пусть $\mu = 7/10,$ $S _{0} = 1/10$, тогда $\phi = tg(\mu)$
  
Отклонение аналитического решения от численного рассчитывается как L2-norm:

Анализ сходимости:

| dx=dy=dz  |  L2-norm $u$ | L2-norm $p$ | Порядок аппроксимации схемы $p$ по L2-norm-$\sigma$ |
| ------------- | ------------- | ------------- | ------------- |


